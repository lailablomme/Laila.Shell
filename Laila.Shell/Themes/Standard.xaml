<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    xmlns:behaviors="clr-namespace:Laila.Shell.Behaviors"
                    xmlns:controls="clr-namespace:Laila.Shell.Controls"
                    xmlns:converters="clr-namespace:Laila.Shell.Converters"
                    xmlns:shell="clr-namespace:Laila.Shell"
                    xmlns:sys="clr-namespace:System;assembly=mscorlib">

    <BitmapImage x:Key="lailaShell_ExplorerMenu_CopyButtonIcon" UriSource="pack://application:,,,/Laila.Shell;component/Images/copy16.png"/>
    <BitmapImage x:Key="lailaShell_ExplorerMenu_CutButtonIcon" UriSource="pack://application:,,,/Laila.Shell;component/Images/cut16.png"/>
    <BitmapImage x:Key="lailaShell_ExplorerMenu_PasteButtonIcon" UriSource="pack://application:,,,/Laila.Shell;component/Images/paste16.png"/>
    <BitmapImage x:Key="lailaShell_ExplorerMenu_RenameButtonIcon" UriSource="pack://application:,,,/Laila.Shell;component/Images/rename16.png"/>
    <BitmapImage x:Key="lailaShell_ExplorerMenu_DeleteButtonIcon" UriSource="pack://application:,,,/Laila.Shell;component/Images/delete16.png"/>
    <BitmapImage x:Key="lailaShell_ExplorerMenu_PinButtonIcon" UriSource="pack://application:,,,/Laila.Shell;component/Images/pin16.png"/>
    <BitmapImage x:Key="lailaShell_Menu_CopyButtonIcon" UriSource="pack://application:,,,/Laila.Shell;component/Images/copy16.png"/>
    <BitmapImage x:Key="lailaShell_Menu_CutButtonIcon" UriSource="pack://application:,,,/Laila.Shell;component/Images/cut16.png"/>
    <BitmapImage x:Key="lailaShell_Menu_PasteButtonIcon" UriSource="pack://application:,,,/Laila.Shell;component/Images/paste16.png"/>
    <BitmapImage x:Key="lailaShell_Menu_RenameButtonIcon" UriSource="pack://application:,,,/Laila.Shell;component/Images/rename16.png"/>
    <BitmapImage x:Key="lailaShell_Menu_DeleteButtonIcon" UriSource="pack://application:,,,/Laila.Shell;component/Images/delete16.png"/>
    <BitmapImage x:Key="lailaShell_Menu_PinButtonIcon" UriSource="pack://application:,,,/Laila.Shell;component/Images/pin16.png"/>
    <BitmapImage x:Key="lailaShell_Menu_MoreOptionsIcon" UriSource="pack://application:,,,/Laila.Shell;component/Images/more_options16.png"/>
    <BitmapImage x:Key="lailaShell_Menu_Windows.InstallIcon" UriSource="pack://application:,,,/Laila.Shell;component/Images/Windows.Install16.png"/>
    <BitmapImage x:Key="lailaShell_Menu_Windows.CompressToIcon" UriSource="pack://application:,,,/Laila.Shell;component/Images/Windows.CompressTo16.png"/>
    <BitmapImage x:Key="lailaShell_Menu_cloudIcon" UriSource="pack://application:,,,/Laila.Shell;component/Images/cloud16.png"/>
    <BitmapImage x:Key="lailaShell_Menu_cloud_downloadIcon" UriSource="pack://application:,,,/Laila.Shell;component/Images/cloud_download16.png"/>
    <BitmapImage x:Key="lailaShell_ExplorerMenu_MoreOptionsIcon" UriSource="pack://application:,,,/Laila.Shell;component/Images/more_options16.png"/>
    <BitmapImage x:Key="lailaShell_ExplorerMenu_Windows.InstallIcon" UriSource="pack://application:,,,/Laila.Shell;component/Images/Windows.Install16.png"/>
    <BitmapImage x:Key="lailaShell_ExplorerMenu_Windows.CompressToIcon" UriSource="pack://application:,,,/Laila.Shell;component/Images/Windows.CompressTo16.png"/>
    <BitmapImage x:Key="lailaShell_ExplorerMenu_cloudIcon" UriSource="pack://application:,,,/Laila.Shell;component/Images/cloud16.png"/>
    <BitmapImage x:Key="lailaShell_ExplorerMenu_cloud_downloadIcon" UriSource="pack://application:,,,/Laila.Shell;component/Images/cloud_download16.png"/>
    <BitmapImage x:Key="lailaShell_ExplorerMenu_ViewIcon" UriSource="pack://application:,,,/Laila.Shell;component/Images/view16.png"/>
    <BitmapImage x:Key="lailaShell_ExplorerMenu_SortIcon" UriSource="pack://application:,,,/Laila.Shell;component/Images/sort16.png"/>
    <BitmapImage x:Key="lailaShell_ExplorerMenu_ExpandIcon" UriSource="pack://application:,,,/Laila.Shell;component/Images/expand16.png"/>
    <BitmapImage x:Key="lailaShell_ExplorerMenu_CollapseIcon" UriSource="pack://application:,,,/Laila.Shell;component/Images/collapse16.png"/>
    <BitmapImage x:Key="lailaShell_Menu_ViewIcon" UriSource="pack://application:,,,/Laila.Shell;component/Images/view16.png"/>
    <BitmapImage x:Key="lailaShell_Menu_SortIcon" UriSource="pack://application:,,,/Laila.Shell;component/Images/sort16.png"/>
    <BitmapImage x:Key="lailaShell_Menu_ExpandIcon" UriSource="pack://application:,,,/Laila.Shell;component/Images/expand16.png"/>
    <BitmapImage x:Key="lailaShell_Menu_CollapseIcon" UriSource="pack://application:,,,/Laila.Shell;component/Images/collapse16.png"/>
    <BitmapImage x:Key="lailaShell_Menu_CompactModeIcon" UriSource="pack://application:,,,/Laila.Shell;component/Images/compactmode16.png"/>
    <BitmapImage x:Key="lailaShell_Menu_CheckboxesForItemsIcon" UriSource="pack://application:,,,/Laila.Shell;component/Images/filecheck16.png"/>
    <BitmapImage x:Key="lailaShell_Menu_FilenameExtensionsIcon" UriSource="pack://application:,,,/Laila.Shell;component/Images/fileext16.png"/>
    <BitmapImage x:Key="lailaShell_Menu_HiddenItemsIcon" UriSource="pack://application:,,,/Laila.Shell;component/Images/eye16.png"/>
    <BitmapImage x:Key="lailaShell_View_ExtraLargeIconsIcon" UriSource="pack://application:,,,/Laila.Shell;component/Images/extralargeicons16.png"/>
    <BitmapImage x:Key="lailaShell_View_LargeIconsIcon" UriSource="pack://application:,,,/Laila.Shell;component/Images/largeicons16.png"/>
    <BitmapImage x:Key="lailaShell_View_NormalIconsIcon" UriSource="pack://application:,,,/Laila.Shell;component/Images/normalicons16.png"/>
    <BitmapImage x:Key="lailaShell_View_SmallIconsIcon" UriSource="pack://application:,,,/Laila.Shell;component/Images/smallicons16.png"/>
    <BitmapImage x:Key="lailaShell_View_ListIcon" UriSource="pack://application:,,,/Laila.Shell;component/Images/list16.png"/>
    <BitmapImage x:Key="lailaShell_View_DetailsIcon" UriSource="pack://application:,,,/Laila.Shell;component/Images/details16.png"/>
    <BitmapImage x:Key="lailaShell_View_TilesIcon" UriSource="pack://application:,,,/Laila.Shell;component/Images/tiles16.png"/>
    <BitmapImage x:Key="lailaShell_View_ContentIcon" UriSource="pack://application:,,,/Laila.Shell;component/Images/content16.png"/>
    <BitmapImage x:Key="lailaShell_ExplorerMenu_ExtraLargeIconsIcon" UriSource="pack://application:,,,/Laila.Shell;component/Images/extralargeicons16.png"/>
    <BitmapImage x:Key="lailaShell_ExplorerMenu_LargeIconsIcon" UriSource="pack://application:,,,/Laila.Shell;component/Images/largeicons16.png"/>
    <BitmapImage x:Key="lailaShell_ExplorerMenu_NormalIconsIcon" UriSource="pack://application:,,,/Laila.Shell;component/Images/normalicons16.png"/>
    <BitmapImage x:Key="lailaShell_ExplorerMenu_SmallIconsIcon" UriSource="pack://application:,,,/Laila.Shell;component/Images/smallicons16.png"/>
    <BitmapImage x:Key="lailaShell_ExplorerMenu_ListIcon" UriSource="pack://application:,,,/Laila.Shell;component/Images/list16.png"/>
    <BitmapImage x:Key="lailaShell_ExplorerMenu_DetailsIcon" UriSource="pack://application:,,,/Laila.Shell;component/Images/details16.png"/>
    <BitmapImage x:Key="lailaShell_ExplorerMenu_TilesIcon" UriSource="pack://application:,,,/Laila.Shell;component/Images/tiles16.png"/>
    <BitmapImage x:Key="lailaShell_ExplorerMenu_ContentIcon" UriSource="pack://application:,,,/Laila.Shell;component/Images/content16.png"/>

    <SolidColorBrush x:Key="Item.MouseOver.Background" Color="#1F26A0DA"/>
    <SolidColorBrush x:Key="Item.MouseOver.Border" Color="#1F26A0DA"/>
    <SolidColorBrush x:Key="Item.Pressed.Background" Color="#1F26A0DA"/>
    <SolidColorBrush x:Key="Item.Pressed.Border" Color="#1F26A0DA"/>
    <SolidColorBrush x:Key="Item.SelectedInactive.Background" Color="#cfcfcf"/>
    <SolidColorBrush x:Key="Item.SelectedInactive.Border" Color="#cfcfcf"/>
    <SolidColorBrush x:Key="Item.SelectedActive.Background" Color="#3D26A0DA"/>
    <SolidColorBrush x:Key="Item.SelectedActive.Border" Color="#FF26A0DA"/>

    <SolidColorBrush x:Key="Menu.BorderBrush" Color="#999999"/>
    <SolidColorBrush x:Key="Menu.Background" Color="#F0F0F0"/>
    <SolidColorBrush x:Key="Menu.Foreground" Color="Black"/>
    <SolidColorBrush x:Key="MenuItem.Highlighted.BorderBrush" Color="#26A0DA"/>
    <SolidColorBrush x:Key="MenuItem.Highlighted.Background" Color="#C0DDEB"/>
    <SolidColorBrush x:Key="MenuItem.Highlighted.Foreground" Color="Black"/>
    <SolidColorBrush x:Key="MenuItem.Disabled.Foreground" Color="Gray"/>

    <Style x:Key="lailaShell_TreeViewSeparatorItemStyle" TargetType="ListBoxItem">
        <Setter Property="SnapsToDevicePixels" Value="True"/>
        <Setter Property="Background" Value="Transparent"/>
        <Setter Property="BorderBrush" Value="Transparent"/>
        <Setter Property="BorderThickness" Value="1"/>
        <Setter Property="FocusVisualStyle" Value="{x:Null}"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="ListBoxItem">
                    <Grid Height="20">
                        <Separator Width="{Binding ActualWidth, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type ListBox}}}">
                        </Separator>
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
    <Style x:Key="lailaShell_TreeViewPlaceholderItemStyle" TargetType="ListBoxItem">
        <Setter Property="SnapsToDevicePixels" Value="True"/>
        <Setter Property="Background">
            <Setter.Value>
                <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                    <GradientStop Color="LightYellow" Offset="0"/>
                    <GradientStop Color="Gold" Offset="1"/>
                </LinearGradientBrush>
            </Setter.Value>
        </Setter>
        <Setter Property="BorderBrush" Value="Goldenrod"/>
        <Setter Property="BorderThickness" Value="1"/>
        <Setter Property="FocusVisualStyle" Value="{x:Null}"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="ListBoxItem">
                    <Grid>
                        <Border x:Name="Bd" BorderBrush="{TemplateBinding BorderBrush}" Margin="2" 
                                BorderThickness="{TemplateBinding BorderThickness}" CornerRadius="5"
                                Background="{TemplateBinding Background}" Padding="4"  
                                SnapsToDevicePixels="True" UseLayoutRounding="True">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="20" />
                                    <ColumnDefinition Width="*" />
                                </Grid.ColumnDefinitions>
                                <Image Source="../Images/info16.png" Width="16" Height="16" VerticalAlignment="Top" HorizontalAlignment="Left" />
                                <TextBlock Grid.Column="1" TextWrapping="Wrap">
                                    Here you will soon find your 5 most frequent used folders while 
                                    you can also start pinning any number of items to this area right now 
                                    by dragging them over here or choosing "Pin item" in it's context menu.
                                </TextBlock>
                            </Grid>
                        </Border>
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
    <Geometry x:Key="ChevronGroupBy">M 0,0 L 5,6 L 10,0</Geometry>
    <Style TargetType="ToggleButton" x:Key="lailaShell_GroupByExpanderToggleButtonStyle">
        <Setter Property="Background" Value="Transparent" />
        <Setter Property="BorderBrush" Value="Transparent" />
        <Setter Property="Height" Value="20" />
        <Setter Property="FocusVisualStyle" Value="{x:Null}" />
        <Setter Property="Focusable" Value="True" />
        <Setter Property="Padding" Value="0,0,0,0" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="ToggleButton">
                    <Border x:Name="Bd" BorderBrush="{TemplateBinding BorderBrush}" VerticalAlignment="Center"
                                BorderThickness="{TemplateBinding BorderThickness}" Padding="{TemplateBinding Padding}" 
                                Background="{TemplateBinding Background}" SnapsToDevicePixels="True" UseLayoutRounding="True">
                        <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                            <Path x:Name="PART_Chevron" Data="{StaticResource ChevronGroupBy}" StrokeThickness="1" Margin="0" 
                              Fill="Transparent" Stroke="DarkBlue" VerticalAlignment="Center" HorizontalAlignment="Center" Width="11" Height="7"/>
                            <ContentPresenter Margin="0,0,0,0" VerticalAlignment="Center" />
                        </StackPanel>
                    </Border>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsChecked" Value="False">
                            <Setter TargetName="PART_Chevron" Property="RenderTransform">
                                <Setter.Value>
                                    <RotateTransform Angle="-90"/>
                                </Setter.Value>
                            </Setter>
                            <Setter TargetName="PART_Chevron" Property="Margin" Value="2,8,-2,-8" />
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
    <Style TargetType="Expander" x:Key="lailaShell_GroupByExpanderStyle">
        <Setter Property="Margin" Value="0,0,-5,0" />
        <Setter Property="Foreground" Value="Black" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="Expander">
                    <Border BorderBrush="{TemplateBinding BorderBrush}"  
                            BorderThickness="{TemplateBinding BorderThickness}">
                        <StackPanel>
                            <DockPanel>
                                <ToggleButton DockPanel.Dock="Left" Margin="12,0,0,0"
                                              Style="{StaticResource lailaShell_GroupByExpanderToggleButtonStyle}" 
                                              IsChecked="{Binding IsExpanded, RelativeSource={RelativeSource TemplatedParent}}">
                                    <ContentPresenter ContentSource="Header" VerticalAlignment="Center" Margin="10,0,0,0"/>
                                </ToggleButton>
                            </DockPanel>
                            <ContentPresenter x:Name="ExpanderContent" Visibility="Collapsed" ContentSource="Content" />
                        </StackPanel>
                    </Border>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsExpanded" Value="True">
                            <Setter TargetName="ExpanderContent" Property="Visibility" Value="Visible"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
    <Style TargetType="Button" x:Key="lailaShell_ContextMenuButtonStyle">
        <Setter Property="Background" Value="Transparent"/>
        <Setter Property="Foreground" Value="Black"/>
        <Setter Property="BorderThickness" Value="1"/>
        <Setter Property="BorderBrush" Value="Transparent"/>
        <Setter Property="Padding" Value="0"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="Button">
                    <Border x:Name="border" Padding="{TemplateBinding Padding}"
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}">
                        <Border x:Name="innerBorder" BorderThickness="1" BorderBrush="Transparent" Background="Transparent">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" />
                        </Border>
                    </Border>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter TargetName="border" Property="Background" Value="#C0DDEB"/>
                            <Setter TargetName="border" Property="BorderBrush" Value="#26A0DA"/>
                            <Setter TargetName="innerBorder" Property="BorderBrush" Value="#A3D1E8"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
    <Style TargetType="ToggleButton" x:Key="lailaShell_ContextMenuToggleButtonStyle">
        <Setter Property="Background" Value="Transparent"/>
        <Setter Property="Foreground" Value="Black"/>
        <Setter Property="BorderThickness" Value="1"/>
        <Setter Property="BorderBrush" Value="Transparent"/>
        <Setter Property="Padding" Value="0"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="ToggleButton">
                    <Border x:Name="border" Padding="{TemplateBinding Padding}"
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}">
                        <Border x:Name="innerBorder" BorderThickness="1" BorderBrush="Transparent" Background="Transparent">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" />
                        </Border>
                    </Border>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter TargetName="border" Property="Background" Value="#C0DDEB"/>
                            <Setter TargetName="border" Property="BorderBrush" Value="#26A0DA"/>
                            <Setter TargetName="innerBorder" Property="BorderBrush" Value="#A3D1E8"/>
                        </Trigger>
                        <Trigger Property="IsChecked" Value="True">
                            <Setter TargetName="border" Property="Background" Value="#C0DDEB"/>
                            <Setter TargetName="border" Property="BorderBrush" Value="#26A0DA"/>
                            <Setter TargetName="innerBorder" Property="BorderBrush" Value="#A3D1E8"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
    <Style TargetType="{x:Type Menu}" x:Key="lailaShell_MenuStyle" BasedOn="{StaticResource {x:Type Menu}}">
        <Style.Resources>
            <Style x:Key="{x:Static MenuItem.SeparatorStyleKey}" TargetType="{x:Type Separator}">
                <Setter Property="Margin" Value="-10,0,0,0" />
            </Style>
            <Style TargetType="MenuItem" BasedOn="{StaticResource lailaShell_MenuItemStyle}" />
        </Style.Resources>
        <Setter Property="Background" Value="Transparent"/>
        <Setter Property="Foreground" Value="{StaticResource Menu.Foreground}"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type Menu}">
                    <Border BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}" 
                                Background="{TemplateBinding Background}" Padding="{TemplateBinding Padding}" 
                                SnapsToDevicePixels="true">
                        <ItemsPresenter SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>
                    </Border>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
    <Style TargetType="{x:Type MenuItem}" x:Key="lailaShell_MenuItemStyle" BasedOn="{StaticResource {x:Type MenuItem}}">
        <Style.Resources>
            <ControlTemplate x:Key="{ComponentResourceKey ResourceId=SubmenuItemTemplateKey, TypeInTargetAssembly={x:Type MenuItem}}" TargetType="{x:Type MenuItem}">
                <Grid SnapsToDevicePixels="true">
                    <Border x:Name="Bg" BorderThickness="1" Background="Transparent" />
                    <Grid Height="22">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition SharedSizeGroup="MenuItemCheckColumnGroup" Width="Auto"/>
                            <ColumnDefinition SharedSizeGroup="MenuItemIconColumnGroup" Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition SharedSizeGroup="MenuItemIGTColumnGroup" Width="Auto"/>
                            <ColumnDefinition Width="17"/>
                        </Grid.ColumnDefinitions>
                        <Border x:Name="GlyphPanel" Height="20" Margin="1" Visibility="Collapsed" Width="22">
                            <Image x:Name="Glyph" Width="16" Height="16" Source="pack://application:,,,/Laila.Shell;component/Images/check16.png" />
                        </Border>
                        <ContentPresenter Grid.Column="1" x:Name="Icon" MaxHeight="16" MaxWidth="16" ContentSource="Icon" Margin="4,1,1,1" SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" VerticalAlignment="Center"/>
                        <ContentPresenter Grid.Column="2" ContentSource="Header" VerticalAlignment="Center" Margin="4,0,0,0" RecognizesAccessKey="True" SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>
                        <TextBlock x:Name="igText" Grid.Column="3" Margin="37,0,0,0" VerticalAlignment="Center" Foreground="Gray" Text="{TemplateBinding InputGestureText}"/>
                    </Grid>
                </Grid>
                <ControlTemplate.Triggers>
                    <Trigger Property="Icon" Value="{x:Null}">
                        <Setter Property="Visibility" TargetName="Icon" Value="Collapsed"/>
                    </Trigger>
                    <Trigger Property="InputGestureText" Value="{x:Null}">
                        <Setter Property="Visibility" TargetName="igText" Value="Collapsed"/>
                    </Trigger>
                    <Trigger Property="IsCheckable" Value="true">
                        <Setter Property="Visibility" TargetName="GlyphPanel" Value="Hidden"/>
                    </Trigger>
                    <Trigger Property="IsChecked" Value="true">
                        <Setter Property="Visibility" TargetName="GlyphPanel" Value="Visible"/>
                    </Trigger>
                    <Trigger Property="IsHighlighted" Value="true">
                        <Setter Property="Foreground" Value="{StaticResource MenuItem.Highlighted.Foreground}"/>
                        <Setter Property="Background" TargetName="Bg" Value="{StaticResource MenuItem.Highlighted.Background}"/>
                        <Setter Property="BorderBrush" TargetName="Bg" Value="{StaticResource MenuItem.Highlighted.BorderBrush}" />
                    </Trigger>
                    <Trigger Property="IsEnabled" Value="false">
                        <Setter Property="Foreground" Value="{StaticResource MenuItem.Disabled.Foreground}"/>
                        <Setter Property="Opacity" TargetName="Glyph" Value="0.30"/>
                        <Setter Property="Opacity" TargetName="Icon" Value="0.30"/>
                    </Trigger>
                    <Trigger Property="IsPressed" Value="true">
                        <Setter Property="Foreground" Value="{StaticResource MenuItem.Highlighted.Foreground}"/>
                        <Setter Property="Background" TargetName="Bg" Value="{StaticResource MenuItem.Highlighted.Background}"/>
                        <Setter Property="BorderBrush" TargetName="Bg" Value="{StaticResource MenuItem.Highlighted.BorderBrush}" />
                    </Trigger>
                </ControlTemplate.Triggers>
            </ControlTemplate>
            <ControlTemplate x:Key="{ComponentResourceKey ResourceId=SubmenuContent, TypeInTargetAssembly={x:Type FrameworkElement}}" TargetType="{x:Type ContentControl}">
                <Border Padding="3" x:Name="PART_Menu" Opacity="0" BorderBrush="{StaticResource Menu.BorderBrush}" 
                    BorderThickness="1" Background="{StaticResource Menu.Background}" Margin="0,0,6,6">
                    <Border.Triggers>
                        <EventTrigger RoutedEvent="Rectangle.Loaded">
                            <BeginStoryboard>
                                <Storyboard>
                                    <DoubleAnimation Duration="0:0:0.2" To="1" Storyboard.TargetProperty="Opacity" Storyboard.TargetName="PART_Menu" />
                                </Storyboard>
                            </BeginStoryboard>
                        </EventTrigger>
                    </Border.Triggers>
                    <Border.Effect>
                        <DropShadowEffect BlurRadius="3" Color="Black" ShadowDepth="3" Opacity="0.5" />
                    </Border.Effect>
                    <ScrollViewer x:Name="PART_ScrollViewer" UseLayoutRounding="True" SnapsToDevicePixels="True"
                              HorizontalScrollBarVisibility="Hidden" VerticalScrollBarVisibility="Auto">
                        <ContentPresenter />
                    </ScrollViewer>
                </Border>
            </ControlTemplate>
            <ControlTemplate x:Key="{ComponentResourceKey ResourceId=TopLevelHeaderTemplateKey, TypeInTargetAssembly={x:Type MenuItem}}" TargetType="{x:Type MenuItem}">
                <Grid SnapsToDevicePixels="true">
                    <Border x:Name="Bg" Background="{TemplateBinding Background}" BorderThickness="1">
                        <StackPanel Orientation="Horizontal">
                            <ContentPresenter x:Name="Icon" ContentSource="Icon" Margin="4,0,6,0" SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" VerticalAlignment="Center"/>
                            <Image x:Name="GlyphPanel" Width="16" Height="16" Source="pack://application:,,,/Laila.Shell;component/Images/check16.png" Margin="7,0,0,0" Visibility="Collapsed" VerticalAlignment="Center" />
                            <ContentPresenter ContentSource="Header" Margin="{TemplateBinding Padding}" RecognizesAccessKey="True" 
                                          SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" />
                        </StackPanel>
                    </Border>
                    <Popup x:Name="PART_Popup" AllowsTransparency="true" Focusable="false" HorizontalOffset="1" IsOpen="{Binding IsSubmenuOpen, RelativeSource={RelativeSource TemplatedParent}}" PopupAnimation="{DynamicResource {x:Static SystemParameters.MenuPopupAnimationKey}}" Placement="Bottom" VerticalOffset="-1">
                        <Border>
                            <ContentControl x:Name="SubMenuBorder" IsTabStop="false" Template="{DynamicResource {ComponentResourceKey ResourceId=SubmenuContent, TypeInTargetAssembly={x:Type FrameworkElement}}}">
                                <ScrollViewer x:Name="PART_ScrollViewer"
                                          HorizontalScrollBarVisibility="Hidden" VerticalScrollBarVisibility="Auto">
                                    <Grid UseLayoutRounding="True" SnapsToDevicePixels="True">
                                        <ItemsPresenter x:Name="ItemsPresenter" KeyboardNavigation.DirectionalNavigation="Cycle" Grid.IsSharedSizeScope="true" Margin="2" KeyboardNavigation.TabNavigation="Cycle"/>
                                    </Grid>
                                </ScrollViewer>
                            </ContentControl>
                        </Border>
                    </Popup>
                </Grid>
                <ControlTemplate.Triggers>
                    <Trigger Property="Icon" Value="{x:Null}">
                        <Setter Property="Visibility" TargetName="Icon" Value="Collapsed"/>
                    </Trigger>
                    <Trigger Property="IsChecked" Value="true">
                        <Setter Property="Visibility" TargetName="GlyphPanel" Value="Visible"/>
                        <Setter Property="Visibility" TargetName="Icon" Value="Collapsed"/>
                    </Trigger>
                    <Trigger Property="IsHighlighted" Value="true">
                        <Setter Property="Foreground" Value="{StaticResource MenuItem.Highlighted.Foreground}"/>
                        <Setter Property="Background" TargetName="Bg" Value="{StaticResource MenuItem.Highlighted.Background}"/>
                        <Setter Property="BorderBrush" TargetName="Bg" Value="{StaticResource MenuItem.Highlighted.BorderBrush}" />
                    </Trigger>
                    <Trigger Property="IsKeyboardFocused" Value="true">
                        <Setter Property="Foreground" Value="{StaticResource MenuItem.Highlighted.Foreground}"/>
                        <Setter Property="Background" TargetName="Bg" Value="{StaticResource MenuItem.Highlighted.Background}"/>
                        <Setter Property="BorderBrush" TargetName="Bg" Value="{StaticResource MenuItem.Highlighted.BorderBrush}" />
                    </Trigger>
                    <Trigger Property="IsEnabled" Value="false">
                        <Setter Property="Foreground" Value="{StaticResource MenuItem.Disabled.Foreground}"/>
                        <Setter Property="Opacity" TargetName="GlyphPanel" Value="0.30"/>
                        <Setter Property="Opacity" TargetName="Icon" Value="0.30"/>
                    </Trigger>
                </ControlTemplate.Triggers>
            </ControlTemplate>
            <ControlTemplate x:Key="{ComponentResourceKey ResourceId=TopLevelItemTemplateKey, TypeInTargetAssembly={x:Type MenuItem}}" TargetType="{x:Type MenuItem}">
                <Grid SnapsToDevicePixels="true">
                    <Border x:Name="Bg" BorderThickness="1" Background="Transparent"/>
                    <DockPanel>
                        <ContentPresenter x:Name="Icon" ContentSource="Icon" Margin="4,0,6,0" SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" VerticalAlignment="Center"/>
                        <Image x:Name="GlyphPanel" Width="16" Height="16" Source="pack://application:,,,/Laila.Shell;component/Images/check16.png" Margin="7,0,0,0" Visibility="Collapsed" VerticalAlignment="Center" />
                        <ContentPresenter ContentSource="Header" Margin="{TemplateBinding Padding}" RecognizesAccessKey="True" SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>
                    </DockPanel>
                </Grid>
                <ControlTemplate.Triggers>
                    <Trigger Property="Icon" Value="{x:Null}">
                        <Setter Property="Visibility" TargetName="Icon" Value="Collapsed"/>
                    </Trigger>
                    <Trigger Property="IsChecked" Value="true">
                        <Setter Property="Visibility" TargetName="GlyphPanel" Value="Visible"/>
                        <Setter Property="Visibility" TargetName="Icon" Value="Collapsed"/>
                    </Trigger>
                    <Trigger Property="IsHighlighted" Value="true">
                        <Setter Property="Foreground" Value="{StaticResource MenuItem.Highlighted.Foreground}"/>
                        <Setter Property="Background" TargetName="Bg" Value="{StaticResource MenuItem.Highlighted.Background}"/>
                        <Setter Property="BorderBrush" TargetName="Bg" Value="{StaticResource MenuItem.Highlighted.BorderBrush}" />
                    </Trigger>
                    <Trigger Property="IsKeyboardFocused" Value="true">
                        <Setter Property="Foreground" Value="{StaticResource MenuItem.Highlighted.Foreground}"/>
                        <Setter Property="Background" TargetName="Bg" Value="{StaticResource MenuItem.Highlighted.Background}"/>
                        <Setter Property="BorderBrush" TargetName="Bg" Value="{StaticResource MenuItem.Highlighted.BorderBrush}" />
                    </Trigger>
                    <Trigger Property="IsEnabled" Value="false">
                        <Setter Property="Foreground" Value="{StaticResource MenuItem.Disabled.Foreground}"/>
                        <Setter Property="Opacity" TargetName="GlyphPanel" Value="0.30"/>
                        <Setter Property="Opacity" TargetName="Icon" Value="0.30"/>
                    </Trigger>
                </ControlTemplate.Triggers>
            </ControlTemplate>
            <Geometry x:Key="RightArrow">M 0,0 L 4,3.5 L 0,7 Z</Geometry>
            <ControlTemplate x:Key="{ComponentResourceKey ResourceId=SubmenuHeaderTemplateKey, TypeInTargetAssembly={x:Type MenuItem}}" TargetType="{x:Type MenuItem}">
                <Grid SnapsToDevicePixels="true" UseLayoutRounding="True">
                    <Border x:Name="Bg" BorderThickness="1" Background="Transparent"/>
                    <Grid Height="22">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition SharedSizeGroup="MenuItemCheckColumnGroup" Width="Auto"/>
                            <ColumnDefinition SharedSizeGroup="MenuItemIconColumnGroup" Width="Auto"/>
                            <ColumnDefinition Width="4"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="37"/>
                            <ColumnDefinition SharedSizeGroup="MenuItemIGTColumnGroup" Width="Auto"/>
                            <ColumnDefinition Width="17"/>
                        </Grid.ColumnDefinitions>
                        <Border x:Name="GlyphPanel" BorderBrush="#CDD3E6" BorderThickness="1" Background="#E6EFF4" CornerRadius="3" Height="20" Margin="1" Visibility="Collapsed" Width="22">
                            <Image x:Name="Glyph" Width="16" Height="16" Source="pack://application:,,,/Laila.Shell;component/Images/check16.png" />
                        </Border>
                        <ContentPresenter Grid.Column="1" x:Name="Icon" Height="16" Width="16" ContentSource="Icon" Margin="4,1,1,1" SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" VerticalAlignment="Center"/>
                        <ContentPresenter Grid.Column="3" ContentSource="Header" VerticalAlignment="Center" Margin="{TemplateBinding Padding}" RecognizesAccessKey="True" SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>
                        <TextBlock Grid.Column="5" Margin="{TemplateBinding Padding}" VerticalAlignment="Center" Text="{TemplateBinding InputGestureText}" Visibility="Collapsed"/>
                        <Path Grid.Column="6" Data="{StaticResource RightArrow}" Fill="{TemplateBinding Foreground}" Margin="4,0,0,0" VerticalAlignment="Center"/>
                    </Grid>
                    <Popup x:Name="PART_Popup" AllowsTransparency="true" Focusable="false" HorizontalOffset="-2" IsOpen="{Binding IsSubmenuOpen, RelativeSource={RelativeSource TemplatedParent}}" PopupAnimation="{DynamicResource {x:Static SystemParameters.MenuPopupAnimationKey}}" Placement="Right" VerticalOffset="-3">
                        <ContentControl x:Name="SubMenuBorder" IsTabStop="false" Template="{DynamicResource {ComponentResourceKey ResourceId=SubmenuContent, TypeInTargetAssembly={x:Type FrameworkElement}}}">
                            <ScrollViewer x:Name="PART_ScrollViewer" SnapsToDevicePixels="true" UseLayoutRounding="True"
                                      HorizontalScrollBarVisibility="Hidden" VerticalScrollBarVisibility="Auto">
                                <Grid>
                                    <ItemsPresenter x:Name="ItemsPresenter" KeyboardNavigation.DirectionalNavigation="Cycle" Grid.IsSharedSizeScope="true" Margin="2" SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" KeyboardNavigation.TabNavigation="Cycle"/>
                                </Grid>
                            </ScrollViewer>
                        </ContentControl>
                    </Popup>
                </Grid>
                <ControlTemplate.Triggers>
                    <Trigger Property="Icon" Value="{x:Null}">
                        <Setter Property="Visibility" TargetName="Icon" Value="Collapsed"/>
                    </Trigger>
                    <Trigger Property="IsCheckable" Value="true">
                        <Setter Property="Visibility" TargetName="GlyphPanel" Value="Hidden"/>
                    </Trigger>
                    <Trigger Property="IsChecked" Value="true">
                        <Setter Property="Visibility" TargetName="GlyphPanel" Value="Visible"/>
                    </Trigger>
                    <Trigger Property="IsHighlighted" Value="true">
                        <Setter Property="Foreground" Value="{StaticResource MenuItem.Highlighted.Foreground}"/>
                        <Setter Property="Background" TargetName="Bg" Value="{StaticResource MenuItem.Highlighted.Background}"/>
                        <Setter Property="BorderBrush" TargetName="Bg" Value="{StaticResource MenuItem.Highlighted.BorderBrush}" />
                    </Trigger>
                    <Trigger Property="IsKeyboardFocused" Value="true">
                        <Setter Property="Foreground" Value="{StaticResource MenuItem.Highlighted.Foreground}"/>
                        <Setter Property="Background" TargetName="Bg" Value="{StaticResource MenuItem.Highlighted.Background}"/>
                        <Setter Property="BorderBrush" TargetName="Bg" Value="{StaticResource MenuItem.Highlighted.BorderBrush}" />
                    </Trigger>
                    <Trigger Property="IsEnabled" Value="false">
                        <Setter Property="Foreground" Value="{StaticResource MenuItem.Disabled.Foreground}"/>
                        <Setter Property="Opacity" TargetName="GlyphPanel" Value="0.30"/>
                        <Setter Property="Opacity" TargetName="Icon" Value="0.30"/>
                    </Trigger>
                </ControlTemplate.Triggers>
            </ControlTemplate>
        </Style.Resources>
        <Setter Property="HorizontalContentAlignment" Value="Left"/>
        <Setter Property="VerticalContentAlignment" Value="Center"/>
    </Style>
    <Style TargetType="{x:Type ContextMenu}" x:Key="lailaShell_ContextMenuStyle" BasedOn="{StaticResource {x:Type ContextMenu}}">
        <Style.Resources>
            <Style x:Key="{x:Static MenuItem.SeparatorStyleKey}" TargetType="{x:Type Separator}">
                <Setter Property="Margin" Value="-10,0,0,0" />
            </Style>
            <Style TargetType="MenuItem" BasedOn="{StaticResource lailaShell_MenuItemStyle}" />
        </Style.Resources>
        <!--<Setter Property="OverridesDefaultStyle" Value="True"/>-->
        <Setter Property="SnapsToDevicePixels" Value="True" />
        <Setter Property="Grid.IsSharedSizeScope" Value="true" />
        <Setter Property="Foreground" Value="Black" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type ContextMenu}">
                    <Border Padding="3" x:Name="PART_Menu" Opacity="0" BorderBrush="{StaticResource Menu.BorderBrush}" BorderThickness="1" 
                            Background="{StaticResource Menu.Background}" Margin="0,0,6,6" UseLayoutRounding="True" SnapsToDevicePixels="True">
                        <Border.Triggers>
                            <EventTrigger RoutedEvent="Rectangle.Loaded">
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation Duration="0:0:0.2" To="1" Storyboard.TargetProperty="Opacity" Storyboard.TargetName="PART_Menu" />
                                    </Storyboard>
                                </BeginStoryboard>
                            </EventTrigger>
                        </Border.Triggers>
                        <Border.Effect>
                            <DropShadowEffect BlurRadius="3" Color="Black" ShadowDepth="3" Opacity="0.5" />
                        </Border.Effect>
                        <ScrollViewer Grid.Row="1" x:Name="PART_ScrollViewer" RenderOptions.ClearTypeHint="Enabled"
                                        HorizontalScrollBarVisibility="Hidden" VerticalScrollBarVisibility="Auto">
                            <ItemsPresenter Margin="0,0,0,1" x:Name="PART_ItemsPresenter" />
                        </ScrollViewer>
                    </Border>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
</ResourceDictionary>
